<!DOCTYPE html>
<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<!-- Bootstrap Stuff -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
    crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
    crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
    crossorigin="anonymous"></script>

<!-- End Bootstrap stuff -->
<html>

<head>
    <!-- Firebase stuff -->
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.2/firebase-messaging.js"></script>
    <script>
        // Initialize Firebase
        var config =
            {
                apiKey: "AIzaSyDqs1V4sQgKsXXe071909_aO_SLy5P7bpE",
                authDomain: "newsapp-5d5a8.firebaseapp.com",
                databaseURL: "https://newsapp-5d5a8.firebaseio.com",
                projectId: "newsapp-5d5a8",
                storageBucket: "newsapp-5d5a8.appspot.com",
                messagingSenderId: "536892297743"
            };

        firebase.initializeApp(config);
    </script>
    <!-- End Firebase stuff -->
</head>

<body>

    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Newsboy</a>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="home.html">Home</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                <div class="well">Article clicked on main screen</div>
                <script>
                    // Query DB for this specific JSON
                    var ref = firebase.database().ref("Keywords/Trump");

                    // Get the value(s) associated with the Trump key
                    ref.once("value")
                        .then(function (snapshot) {
                            var articleName = snapshot.child("article").val();
                            //console.log(articleName);
                        });
                </script>
                <div>
                    <a class="btn btn-info btn-md">
                    <span class="glyphicon glyphicon-thumbs-up" onclick="updateThumbsUp('aniceKey')"></span>
                </a>
                    <a class="btn btn-danger btn-md">
                    <span class="glyphicon glyphicon-thumbs-down" onclick="updateThumbsDown('aniceKey2')"></span>
                </a>
                    <div id="id_origSlideCtnr">
                        <input type="range" min="1" max="5" value="3" class="slider" id="id_origLeaning">
                        <span id="id_origLeaningOutput">Center</span>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="well">Random article fetched for comparison</div>
                <div>
                    <a class="btn btn-info btn-md">
                    <span class="glyphicon glyphicon-thumbs-up" onclick="updateThumbsUp('aniceKey')"></span>
                </a>
                    <a class="btn btn-danger btn-md">
                    <span class="glyphicon glyphicon-thumbs-down" onclick="updateThumbsDown('aniceKey2')"></span>
                </a>
                    <div id="id_refSlideCtnr">
                        <input type="range" min="1" max="5" value="3" class="slider" id="id_refLeaning">
                        <span id="id_refLeaningOutput">Center</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>

<script>
// TODO
// Make this not happen until the page is loaded
var valueFromHome = localStorage.getItem("Hello");

var originalSlider = document.getElementById("id_origLeaning");
var comparisonSlider = document.getElementById("id_refLeaning");

// TODO
// Condense these two functions into one
originalSlider.oninput = function() 
{
    var textReplacement;

    if (this.value == 1)
    {
        textReplacement = "Left";
    }
    else if (this.value == 2)
    {
        textReplacement = "Center Left";
    }
    else if (this.value == 3)
    {
        textReplacement = "Center";
    }
    else if (this.value == 4)
    {
        textReplacement = "Center Right";
    }
    else
    {
        textReplacement = "Right";
    }

    $("#id_origLeaningOutput").text(textReplacement);
}

comparisonSlider.oninput = function() 
{
    var textReplacement;

    if (this.value == 1)
    {
        textReplacement = "Left";
    }
    else if (this.value == 2)
    {
        textReplacement = "Center Left";
    }
    else if (this.value == 3)
    {
        textReplacement = "Center";
    }
    else if (this.value == 4)
    {
        textReplacement = "Center Right";
    }
    else
    {
        textReplacement = "Right";
    }

    $("#id_refLeaningOutput").text(textReplacement);
}

// TODO
// Change this in the two article clicks
function updateThumbsUp(articleKey)
{
    incrementSpecificPath("Articles/aa2/Rating", "Thumbs Up");
}

function updateThumbsDown(articleKey)
{
    incrementSpecificPath("Articles/aa2/Rating", "Thumbs Down");
}

function incrementSpecificPath(parentPath, childName)
{
    var ref = firebase.database().ref(parentPath);

    ref.once("value").then(function(snapshot) 
    {
        var val = snapshot.child(childName).val() + 1;
        var specificRef = firebase.database().ref(parentPath + "/" + childName);
        specificRef.set(val);
    });
    /*
    ref.once("value").then(function(snapshot) 
    {
        var numOfThumbsUp = snapshot.child("Thumbs Up").val() + 1;
        console.log("Number of thumbs up: " + numOfThumbsUp);

        var ratingRef = firebase.database().ref('Articles/aa2/Rating/Thumbs Up');
        ratingRef.set(numOfThumbsUp);
    });
    */

    /* EXAMPLE
    var ref = firebase.database().ref("Articles/aa2/Rating");
    ref.once("value").then(function (snapshot) 
    {
        var numOfThumbsUp = snapshot.child("Thumbs Up").val() + 1;
        console.log("Number of thumbs up: " + numOfThumbsUp);

        //var ratingRef = firebase.database().ref('Articles/aa2/Rating');
        //ratingRef.set({"Thumbs Up" : numOfThumbsUp});
        var ratingRef = firebase.database().ref('Articles/aa2/Rating/Thumbs Up');
        ratingRef.set(numOfThumbsUp);
    });
    */
}

</script>